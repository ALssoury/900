<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALssouRy_Station</title> 
    
    <link rel="stylesheet" href="btn.css">
    
    <script src="bundle.js"></script>
    <script src="bundle_reference.js"></script>
    
    <script>
        // دالة يتم استدعاؤها عند النقر على زر "ابدأ الاستغلال"
        function startExploitManual() {
            // إخفاء زر البدء وإظهار شريط التحميل
            document.getElementById("exploitButtonContainer").style.display = 'none';
            document.getElementById("loadingContainer").style.display = 'block';
            window.log("[INFO] Starting Exploit manually...");
            
            // استدعاء دالة الاستغلال الرئيسية
            if (window.doJBwithPSFreeLapseExploit) {
                window.doJBwithPSFreeLapseExploit();
            } else {
                window.log('[ERROR] Exploit function (doJBwithPSFreeLapseExploit) not found. Check bundle.js.');
            }
        }

        // دالة جديدة لتحميل أي حمولة يختارها المستخدم بعد نجاح الاستغلال
        async function loadCustomPayload(payloadFileName) {
            document.getElementById("mymenu").style.display = 'none'; 
            window.log(`[PAYLOAD] Loading ${payloadFileName}...`);
            const jb_step_status = await PayloadLoader(payloadFileName, 1); 

            if (jb_step_status === 1) {
                window.log(`[SUCCESS] ${payloadFileName} loaded successfully.`);
            } else {
                window.log(`[ERROR] Failed to load ${payloadFileName}.`);
            }
        }
        
        // لإظهار القائمة بعد اكتمال تحميل GoldHEN (يتم استدعاؤها من bundle.js)
        function jbdone() {
            // يتم إخفاء شريط التحميل وعرض القائمة
            document.getElementById("loadingContainer").style.display = 'none'; 
            document.getElementById("mymenu").style.display = 'block';
        }

        // Logging utility - لضمان عمل الكونسول
        window.log = (msg) => { 
            const consoleElement = document.getElementById("console");
            if (consoleElement) {
                consoleElement.textContent += msg + "\n";
                consoleElement.scrollTop = consoleElement.scrollHeight;
            }
        };

    </script>
    
    <style>
        /* الأنماط العامة */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: url('alssoury_1ogo.jpg') center center / cover no-repeat,
                        linear-gradient(to bottom right, #063FAB, #01258A);
            color: white;
            font-family: Arial, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            overflow: auto; 
        }

        @font-face {
            font-family: 'logging';
            src: url('fonts/LiberationMono-Regular.ttf');
        }
        
        /* نمط الزر الرئيسي الجديد للاستغلال - يستخدم نفس لون زر العودة */
        .big-exploit-btn {
            padding: 25px 50px;
            font-size: 28px;
            background-color: #007bff; /* نفس لون زر العودة */
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 123, 255, 0.7); /* ظل مطابق للون */
            transition: background-color 0.2s;
            font-weight: bold;
            margin-bottom: 20px; /* تباعد عن الكونسول */
        }
        .big-exploit-btn:hover {
            background-color: #0056b3;
        }

        .menu-card {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 40px 20px;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 700px;
            margin-top: 50px; 
        }

        #console {
            font-family: 'logging', monospace;
            font-size: 18px;
            text-align: left;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            border-radius: 10px;
            white-space: pre-wrap;
            height: 300px;
            overflow-y: auto;
            width: 90%; 
            max-width: 700px;
            margin: 20px auto;
        }
        
        /* زر العودة - نفس الأسلوب */
        .back-button {
            display: block;
            margin: 20px auto; 
            text-align: center;
            padding: 15px 30px; 
            background-color: #007bff; /* اللون الأزرق القياسي */
            color: white;
            text-decoration: none; 
            border-radius: 8px; 
            width: fit-content; 
            font-size: 18px; 
            transition: background-color 0.3s ease; 
        }
        .back-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body style="text-align: center;">
    
    <a href="https://alssoury.github.io/MS" class="back-button" style="margin-top: 50px;">
        Back To ALssouRy_Station
    </a>

    <div id="exploitButtonContainer" style="display:block; text-align: center; margin-top: 20px;">
        <button id="startExploitBtn" onclick="startExploitManual()" class="big-exploit-btn">
            ابدأ الاستغلال (Start Exploit)
        </button>