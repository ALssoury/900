<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALssouRy_Station - 9.00 AIO (USB-less)</title> 
    
    <!-- تحميل ملف bundle.js الضروري للاستغلال المتكامل (AIO) -->
    <!-- هذا الملف يحتوي على كامل منطق الـ Exploit وحقن GoldHEN بدون الحاجة لفلاشة -->
    <script src="bundle.js"></script>
    <script src="payload.js"></script>
    
    <script>
        // Logging utility - لضمان عمل الكونسول
        window.log = (msg) => { 
            const consoleElement = document.getElementById("console");
            if (consoleElement) {
                consoleElement.textContent += msg + "\n";
                consoleElement.scrollTop = consoleElement.scrollHeight;
            }
            console.log(msg); // للمطورين
        };

        // دالة يتم استدعاؤها عند النقر على زر "ابدأ الاستغلال"
        function startExploitManual() {
            // إخفاء زر البدء وإظهار شريط التحميل
            document.getElementById("exploitButtonContainer").style.display = 'none';
            document.getElementById("loadingContainer").style.display = 'block';
            window.log("[INFO] Starting AIO Exploit (USB-less)...");
            
            // =======================================================
            // المنطق الجديد: استدعاء دالة الاستغلال الرئيسية من bundle.js
            // =======================================================
            if (window.doJBwithPSFreeLapseExploit) {
                // يُرجى ملاحظة: هذه الدالة تقوم تلقائياً بتحميل GoldHEN و AIO Fix
                window.doJBwithPSFreeLapseExploit(); 
                
                // تحديث مؤشر النص بعد البدء
                const qElement = document.getElementById('q');
                if (qElement) {
                    qElement.innerHTML = 'Starting Exploit (Check Console)';
                }
            } else {
                window.log('[FATAL ERROR] Exploit function (doJBwithPSFreeLapseExploit) not found. Check if bundle.js is loaded correctly.');
                // إعادة إظهار زر البدء في حالة الفشل
                document.getElementById("exploitButtonContainer").style.display = 'block';
                document.getElementById("loadingContainer").style.display = 'none';
            }
        }

        // دالة لتحميل أي حمولة يختارها المستخدم بعد نجاح الاستغلال 
        // تعتمد على أن دالة PayloadLoader متوفرة عالمياً (غالباً من bundle.js أو payload.js)
        async function loadCustomPayload(payloadFileName) {
            document.getElementById("mymenu").style.display = 'none'; 
            window.log(`[PAYLOAD] Loading ${payloadFileName}...`);
            
            if (window.PayloadLoader) {
                // استخدام 1 لتعني 'قرأ من ملف .bin' بدلاً من مصفوفة بايت
                const jb_step_status = await PayloadLoader(payloadFileName, 1); 

                if (jb_step_status === 1) {
                    window.log(`[SUCCESS] ${payloadFileName} loaded successfully.`);
                } else {
                    window.log(`[ERROR] Failed to load ${payloadFileName}.`);
                }
            } else {
                window.log('[FATAL ERROR] PayloadLoader function not found. Did the AIO exploit succeed?');
                document.getElementById("mymenu").style.display = 'block'; // عرض القائمة مرة أخرى
            }
        }
        
        // لإظهار القائمة بعد اكتمال تحميل الاستغلال (يجب أن يتم استدعاؤها من bundle.js)
        function jbdone() {
            document.getElementById("loadingContainer").style.display = 'none'; 
            document.getElementById("mymenu").style.display = 'block';
            window.log("[SUCCESS] Exploit Done. GoldHEN is Ready. Select a Payload.");
        }
        // اجعلها متاحة لـ bundle.js
        window.jbdone = jbdone;

        // إزالة دوال loadScript القديمة لأننا نستخدم bundle.js
    </script>
    
    <style>
        /* الأنماط العامة (كما كانت في index.html) */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            /* ملاحظة: image_2cfe76.jpg كانت صورة مشهورة للـ 9.00 exploit. قمت بتحديثها للاسم الذي استخدمته أنت. */
            background: url('alssoury_1ogo.jpg') center center / cover no-repeat,
                        linear-gradient(to bottom right, #063FAB, #01258A);
            color: white;
            font-family: Arial, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            overflow: auto; 
        }

        @font-face {
            font-family: 'logging';
            /* يُفترض أن المسار fonts/LiberationMono-Regular.ttf صحيح */
            src: url('fonts/LiberationMono-Regular.ttf');
        }
        
        /* نمط الزر الرئيسي للاستغلال */
        .big-exploit-btn {
            padding: 25px 50px;
            font-size: 28px;
            background-color: #007bff; 
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 123, 255, 0.7); 
            transition: background-color 0.2s;
            font-weight: bold;
            margin-bottom: 20px; 
            direction: rtl; /* لدعم النص العربي */
        }
        .big-exploit-btn:hover {
            background-color: #0056b3;
        }

        /* نمط بطاقة القائمة */
        .menu-card {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 40px 20px;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 700px;
            margin-top: 50px; 
            direction: rtl; /* لدعم النص العربي */
        }
        
        /* نمط أزرار البايلود الداخلية */
        .btn {
            padding: 12px 25px;
            font-size: 18px;
            margin: 8px;
            background-color: #333; 
            color: #fff;
            border: 2px solid #555;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            display: inline-block;
            min-width: 150px;
        }

        .btn:hover {
            background-color: #555;
            border-color: #007bff;
        }


        #console {
            font-family: 'logging', monospace;
            font-size: 18px;
            text-align: left;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            border-radius: 10px;
            white-space: pre-wrap;
            height: 300px;
            overflow-y: auto;
            width: 90%; 
            max-width: 700px;
            margin: 20px auto;
            direction: ltr; /* لضمان ظهور رسائل الكونسول بشكل صحيح */
        }
        
        /* زر العودة */
        .back-button {
            display: block;
            margin: 20px auto; 
            text-align: center;
            padding: 15px 30px; 
            background-color: #007bff; 
            color: white;
            text-decoration: none; 
            border-radius: 8px; 
            width: fit-content; 
            font-size: 18px; 
            transition: background-color 0.3s ease; 
        }
        .back-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body style="text-align: center;">
    
    <a href="https://alssoury.github.io/MS" class="back-button" style="margin-top: 50px;">
        Back To ALssouRy_Station
    </a>
    
    <div id="q" style="color: #E0E0E0; margin-top: 10px; font-size: 18px;">Ready. Click Start.</div> 


    <div id="exploitButtonContainer" style="display:block; text-align: center; margin-top: 20px;">
        <button id="startExploitBtn" onclick="startExploitManual()" class="big-exploit-btn">
            ابدأ الاستغلال المتكامل (Start AIO Exploit)
        </button>
        <p style="color: #ccc; margin-top: 10px; font-size: 18px;">انقر للبدء بدون فلاشة</p>
    </div>

    <div id="loadingContainer" style="display:none; margin-top: 5%;">
        <div id="progress" style="display:block;">
            <h1 style="font-size:25px;text-align:center; color: #E0E0E0;">
                جاري تشغيل الاستغلال... يرجى الانتظار!
            </h1>
        </div>
    </div>

    <div id="mymenu" class="menu-card" style="display:none;">
        
        <h1 style="font-size:25px; color: #E0E0E0; margin-bottom: 20px;">
            خيارات إضافية (Payloads)
        </h1>

        <div style="margin: 15px;">
            <p style="font-size:18px; color: #999;">تغيير إصدار GoldHEN:</p>
            <button class="btn" onclick="loadCustomPayload('pl_goldhen23.bin')">GoldHEN 2.30</button>
            <button class="btn" onclick="loadCustomPayload('pl_goldhenlite.bin')">GoldHEN Lite</button>
            <button class="btn" onclick="loadCustomPayload('pl_goldhenbeta.bin')">GoldHEN Beta</button>
        </div>
        
        <hr style="width: 80%; border-color: #333; margin: 15px auto;">

        <div style="margin: 15px;">
            <p style="font-size:18px; color: #999;">أدوات إضافية:</p>
            <button class="btn" onclick="loadCustomPayload('pl_ftp.bin')">FTP Server</button>
            <button class="btn" onclick="loadCustomPayload('pl_ps4debug.bin')">PS4 Debug</button>
            <button class="btn" onclick="loadCustomPayload('pl_appdumper.bin')">App Dumper</button>
            <button class="btn" onclick="loadCustomPayload('pl_app2usb.bin')">App2USB</button>
        </div>
        
        <hr style="width: 80%; border-color: #333; margin: 15px auto;">

        <div style="margin: 15px;">
            <p style="font-size:18px; color: #999;">النظام والتحميل:</p>
            <button class="btn" onclick="loadCustomPayload('pl_OrbisToolbox.bin')">Orbis Toolbox</button>
            <button class="btn" onclick="loadCustomPayload('pl_disableupdates.bin')">Disable Updates</button>
            <button class="btn" onclick="loadCustomPayload('pl_kerneldumper.bin')">Kernel Dumper</button>
        </div>

        <hr style="width: 80%; border-color: #333; margin: 15px auto;">

        <div style="margin: 15px;">
            <p style="font-size:18px; color: #999;">Linux Loaders:</p>
            <button class="btn" onclick="loadCustomPayload('pl_LinuxLoader.js')">Linux 1GB</button>
            <button class="btn" onclick="loadCustomPayload('pl_LinuxLoader3gb.js')">Linux 3GB</button>
        </div>
        
        <div style="margin-top: 50px;">
            <p style="color: #999; font-size: 16px;">
                **ملاحظة:** عادةً ما يتم تحميل GoldHEN أولاً تلقائياً في هذا الإصدار المتكامل.
            </p>
        </div>
    </div>
    
    <pre id="console"></pre>
    
    <script type="module" src="./alert.mjs"></script>

</body>
</html>