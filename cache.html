<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Service Worker Installer</title>
    <style>
      body {
        background-color: #252526;
        color: #cccccc;
        font-family: "Segoe UI", Tahoma, sans-serif;
        text-align: center;
      }
      #console {
        margin-top: 50px;
        font-family: monospace;
        background-color: #1e1e1e;
        color: #cccccc;
        border: 1px solid #3c3c3c;
        padding: 12px;
        border-radius: 6px;
        text-align: left;
        display: inline-block;
        max-width: 90%; /* لضمان التجاوب على شاشات الأجهزة */
        white-space: pre-wrap; /* للسماح بكسر الأسطر الطويلة */
      }
    </style>
  </head>
  <body>
    <h2>Caching Files... Please Wait.</h2>
    <pre id="console"></pre>
    <script>
      const outputConsole = document.getElementById("console");
      window.log = (msg) => { 
        outputConsole.textContent += msg + "\\n"; 
        outputConsole.scrollTop = outputConsole.scrollHeight; // التمرير للأسفل تلقائياً
      };

      document.addEventListener('DOMContentLoaded', () => {
        window.log("Starting Service Worker registration...");

        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/sw.js', { scope: './' })
            .then(function(reg) {
              window.log("[SUCCESS] Service Worker registered.");
              window.log("[INFO] Caching files (v22) in the background...");
              // تم زيادة وقت الانتظار إلى 8 ثوانٍ لإتاحة مزيد من الوقت للكاش
              window.log("Redirecting to Exploit Page (900.html) in 8 seconds...");
              setTimeout(function() { window.location.replace("900.html"); }, 8000); 
            })
            .catch(function(error) {
              window.log("[ERROR] Service Worker registration failed: " + error);
              // توجيه احتياطي في حالة الفشل
              window.log("Redirecting to Exploit Page (900.html) in 3 seconds as fallback...");
              setTimeout(function() { window.location.replace("900.html"); }, 3000); 
            });
        } else {
          window.log("[WARNING] Service Worker not supported. Redirecting to 900.html directly.");
          setTimeout(function() { window.location.replace("900.html"); }, 3000); 
        }
      });
    </script>
  </body>
</html>